<script type="text/javascript"
        src="http://maps.googleapis.com/maps/api/js?libraries=places&key=AIzaSyAqPJM7UHDfLFx5a8v192BuKLi7BAN69_s&sensor=true">
</script>
<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js"></script>
<link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.9/themes/base/jquery-ui.css" rel="stylesheet" type="text/css"/>
<%= stylesheet_link_tag 'gmaps4rails' %>


<div class="container">
    <div class="navbar">
      <div class="navbar-inner">
        <div class="navWraper offset1"
             style="margin-top: 85px; font-size: 22px; font-weight:bold;
                 color: saddlebrown;">
          Search :
          <input type="text" value="" id="searchbox"
                 style=" width:555px; height:25px; font-size:14px;">

          <button id="search" class="btn btn-info btn" role="button"
                  style="margin-top: -7px">
            Search
          </button>

          <button id="claimPlace" class="btn btn-info btn" role="button"
                  style="margin-top: -7px">
            Claim Your Store!
          </button>


        </div>
      </div>
    </div>
  </div>

<div id="map-canvas" style="width:100%; height: 600px; margin-top: 75px;"></div>

<div class="span6 offset12">
  <img src="/assets/powered-by-google-on-white.png"/>
</div>




<script type="text/javascript">
  $(document).ready(function(){
    var mapOptions = {
      zoom: 18,
      center: new google.maps.LatLng(25.033493,121.564101),
      disableDefaultUI: true,
      panControl: false,
      zoomControl: true,
      scaleControl: false,
      mapTypeId: google.maps.MapTypeId.ROADMAP,
      mapTypeControl: true,
      mapTypeControlOptions: {
            style: google.maps.MapTypeControlStyle.DROPDOWN_MENU
          },
          zoomControl: true,
          zoomControlOptions: {
            style: google.maps.ZoomControlStyle.SMALL
          }
    }

    var map = new google.maps.Map(document.getElementById("map-canvas"),mapOptions);

    var geocoder = new google.maps.Geocoder();

    $(function() {
      $("#searchbox").autocomplete({

        source: function(request, response) {

          if (geocoder == null){
            geocoder = new google.maps.Geocoder();
          }
          geocoder.geocode( {'address': request.term }, function(results, status) {
            if (status == google.maps.GeocoderStatus.OK) {

              var searchLoc = results[0].geometry.location;
              var lat = results[0].geometry.location.lat();
              var lng = results[0].geometry.location.lng();
              var latlng = new google.maps.LatLng(lat, lng);
              var bounds = results[0].geometry.bounds;

              geocoder.geocode({'latLng': latlng}, function(results1, status1) {
                if (status1 == google.maps.GeocoderStatus.OK) {
                  if (results1[1]) {
                    response($.map(results1, function(loc) {
                      return {
                        label  : loc.formatted_address,
                        value  : loc.formatted_address,
                        bounds   : loc.geometry.bounds
                      }
                    }));
                  }
                }
              });
            }
          });
        },
        select: function(event,ui){
          var pos = ui.item.position;
          var lct = ui.item.locType;
          var bounds = ui.item.bounds;

          if (bounds){
            map.fitBounds(bounds);
          }
        }
      });
    });
  });
</script>