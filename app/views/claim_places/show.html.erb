<div class="container claimPlacesContainer">
    <div class="storeName"> <%= @claimPlace.storeName %> </div>

    

    <address class="span11">
      <div class="claimPlace">
      <%= link_to("Edit Your Store", edit_claim_place_path(@claimPlace) ,
                  :class => "btn btn-mini")%>

      <%= link_to("Post New Product", new_claim_place_product_path(@claimPlace) ,
                  :class => "btn btn-mini btn-primary")%>
      </div>

      <strong><%= @claimPlace.address %></strong><br>
      <abbr title="Phone">Phone:</abbr> <%= @claimPlace.ownerPhone %><br>
      <a href="mailto:#"><%= @claimPlace.ownerEmail %></a>
    </address>

    <p class="sotreDescription span12"> <%= @claimPlace.description %> </p>

    <div class="productsLength" style="display: none"><%= @products.length %></div>

    <div class="productList row-fluid">
      <% @products.each_with_index do |product,index| %>
        <div class="prodcut span12" style="margin-left: 0;">
          <div class="productName span12">
            <%= product.productName %>
            <%= link_to("Edit", edit_claim_place_product_path(product.claim_place_id, product), :class=>"btn btn-mini")%>
            <%= link_to("Delete", claim_place_product_path(product.claim_place_id, product), :class => "btn btn-mini",:method=>:delete,:confirm=>"Are you sure?")%>
          </div>

          <div class="row-fluid">
            <div class="span5">
              <canvas id="coffeeRadarChart_<%= index %>" class="span5" width="450px" height="380px"></canvas>

              <div class="description span12">
                Description : <%= product.description %>
              </div>
            </div>

            <div class="product span6 offset1">
              <ol class="radarValue" style="display: none">
                <li><%= product.fragrance %></li>
                <li><%= product.flavor %></li>
                <li><%= product.aftertaste %></li>
                <li><%= product.acidity %></li>
                <li><%= product.body %></li>
                <li><%= product.balance %></li>
                <li><%= product.overall %></li>
              </ol>

              <table id="scaaItem" class="span5 table table-hover">
                  <tr>
                    <td>Fragrance</td>
                    <td><%= product.fragrance %></td>
                  </tr>
                  <tr>
                    <td>Flavor</td>
                    <td><%= product.flavor %></td>
                  </tr>
                  <tr>
                    <td>Aftertaste</td>
                    <td><%= product.aftertaste %></td>
                  </tr>
                  <tr>
                    <td>Acidity</td>
                    <td><%= product.acidity %></td>
                  </tr>
                  <tr>
                    <td>Body</td>
                    <td><%= product.body %></td>
                  </tr>
                  <tr>
                    <td>Uniformity</td>
                    <td><%= product.uniformity %></td>
                  </tr>
                  <tr>
                    <td>Balance</td>
                    <td><%= product.balance %></td>
                  </tr>
                  <tr>
                    <td>CleanCup</td>
                    <td><%= product.cleanCup %></td>
                  </tr>
                  <tr>
                    <td>Sweetness</td>
                    <td><%= product.sweetness %></td>
                  </tr>
                  <tr>
                    <td>Overall</td>
                    <td><%= product.overall %></td>
                  </tr>
                  <tr>
                    <td>Taint</td>
                    <td><%= product.taint %></td>
                  </tr>
                  <tr>
                    <td>Fault</td>
                    <td><%= product.fault %></td>
                  </tr>
                  <tr class="success">
                    <td>TotalScore</td>
                    <td><%= product.totalScore %></td>
                  </tr>
              </table>
            </div>
          </div>
        </div>


      <% end %>
    </div>

</div>

<style type="text/css">

</style>

<script type="text/javascript">
  $(document).ready(function(){
    //Get all product score
    var scaaScoreLength = $(".radarValue li").length;
    var scaaArray = new Array(scaaScoreLength);
    scaaArray = getSCAAScore(scaaScoreLength);

    var option = {
      //Boolean - If we show the scale above the chart data
      scaleOverlay : true, 
      //Boolean - If we want to override with a hard coded scale 
      scaleOverride : true,
      //** Required if scaleOverride is true **
      //Number - The number of steps in a hard coded scale
      scaleSteps : 5,
      //Number - The value jump in the hard coded scale
      scaleStepWidth : 2,
      //Number - The centre starting value
      scaleStartValue : 0,
      //Boolean - Whether to show labels on the scale 
      scaleShowLabels : true,
      scaleFontSize : 14,
      //Function - Fires when the animation is complete
      onAnimationComplete : null
    }

    var times = scaaArray.length / 7;
    var data = {};
//    var ctx1 = $("#coffeeRadarChart_0").get(0).getContext("2d");
//    var ctx2 = $("#coffeeRadarChart_1").get(0).getContext("2d");

    for (var i = 0; i<times; i++){
     // var myNewChart1 = new Chart(ctx1);
     // var myNewChart2 = new Chart(ctx2);

      var partScaaArray = new Array(7);

      $.each(scaaArray,function(j){

        var arrayStart = (i+1)*7-7;

        if(times == j+1){
          return false;
        } else{
          for(var k=0; k<7; k++){
            partScaaArray[k] = scaaArray[arrayStart+k];
          }
        }

      });

      data = {
        labels : ["Fragrance","Flavor","Aftertaste","Acidity","Body","Balance","Overall"],
        datasets : [
          {
            fillColor : "rgba(128,64,0,0.7)",    //填充顏色
            strokeColor : "rgba(220,220,220,1)", //邊框顏色
            pointColor : "rgba(255,220,220,1)",  //節點顏色
            pointStrokeColor : "#111",           //節點邊框顏色
            data : partScaaArray
          }
        ]
      }

      new Chart($("#coffeeRadarChart_"+i).get(0).getContext("2d")).Radar(data,option);

    }

//    new Chart(ctx1).Radar(data,option);
//    new Chart(ctx2).Radar(data,option);
  });

  function getSCAAScore(scaaScoreLength) {
    var scaaScoreLength = scaaScoreLength;
    var scaaArray = new Array(scaaScoreLength);
    $(scaaArray).each(function (i) { scaaArray[i] = 0; });

    $(".radarValue li").each(function(i){
      scaaArray[i] = parseFloat($.trim($(this).text()));
    });

    return scaaArray
  }


</script>